# Mysql：事务/隔离级别/传播机制

事务又名为**TCL**，全称是transanction control language，意思是事务控制语言，ACID为事务的四大特性，分别为：Atomicity原子性、Consistent一致性、**Isolation隔离性**、Durability持久性

    数据库通过原子性、隔离性、持久性，来保证一致性，也就是说在ACID四大特性之中，C是目的，AID是实现C的手段，为了保证C，必须实现AID三大特性

如果没有**Isolation隔离性**，一个操作会导致四种不同的**不一致情况**，包括：脏读、可重复读、不可重复读、幻读。针对这些情况，事务提供了不同的隔离级别以支持做到不同程度的隔离性

# **1. 事务的ACID**

假设这样的场景：A账户向B账户转账100块人民币

## **1.1 Atomicity原子性**

一个事务是一个不可分割的工作单位。包含的所有操作要么全部成功，要么全部失败回滚，因此事务操作如果成功，则要**完全应用**到数据库，如果操作失败，则不能对数据库有任何影响，**不存在任何中间状态**

如果无法保证原子性：

    A扣了100块后，立即宕机，B账户并没有获得这100块钱
    
    假设这个过程没宕机，存在其他用户看到到A的账户-100，但是B的账户没有+100的中间状态，这也不符合原子性

## **1.2 Consistency一致性**

事务执行前后，数据处于一种合法的状态，这种合法状态由我们决定，也就是说一致性其实是根据业务需求而界定的

它是一个目的，为AID是实现它的必要前提

## **1.3 Isolation隔离性**



## **1.4 Durability持久性**

事务一旦提交，它对于数据库的改变应是**永久性**的，接下来的其他操作或故障对其不应有影响

为了解决外存和内存的读写速度差异，Mysql会将磁盘上的数据加载到内存，对内存进行操作再对磁盘进行回写，如果无法保证持久性：
    
    假设事务在A和B的转账操作成功了，但是在回写磁盘过程中宕机，则内存修改的数据全部丢失，即无法持久化

# **2. 隔离级别**

# **3. 传播机制**

# 参考
- [MySQL事务隔离级别和实现原理](https://zhuanlan.zhihu.com/p/117476959)
- [数据库事务的四大特性](https://www.cnblogs.com/fjdingsd/p/5273008.html)

# 重点参考
- [事务的四大特性，以及实现原理](https://blog.csdn.net/star1210644725/article/details/96829608)